<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gradient Descent ¬∑ Manopt.jl</title><meta name="title" content="Gradient Descent ¬∑ Manopt.jl"/><meta property="og:title" content="Gradient Descent ¬∑ Manopt.jl"/><meta property="twitter:title" content="Gradient Descent ¬∑ Manopt.jl"/><meta name="description" content="Documentation for Manopt.jl."/><meta property="og:description" content="Documentation for Manopt.jl."/><meta property="twitter:description" content="Documentation for Manopt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Manopt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Manopt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../about/">About</a></li><li><span class="tocitem">How to...</span><ul><li><a class="tocitem" href="../../tutorials/Optimize/">üèîÔ∏è Get started: optimize.</a></li><li><a class="tocitem" href="../../tutorials/InplaceGradient/">Speedup using in-place computations</a></li><li><a class="tocitem" href="../../tutorials/AutomaticDifferentiation/">Use automatic differentiation</a></li><li><a class="tocitem" href="../../tutorials/EmbeddingObjectives/">Define objectives in the embedding</a></li><li><a class="tocitem" href="../../tutorials/CountAndCache/">Count and use a cache</a></li><li><a class="tocitem" href="../../tutorials/HowToDebug/">Print debug output</a></li><li><a class="tocitem" href="../../tutorials/HowToRecord/">Record values</a></li><li><a class="tocitem" href="../../tutorials/ImplementASolver/">Implement a solver</a></li><li><a class="tocitem" href="../../tutorials/ImplementOwnManifold/">Optimize on your own manifold</a></li><li><a class="tocitem" href="../../tutorials/ConstrainedOptimization/">Do constrained optimization</a></li><li><a class="tocitem" href="../../tutorials/GeodesicRegression/">Do geodesic regression</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../adaptive-regularization-with-cubics/">Adaptive Regularization with Cubics</a></li><li><a class="tocitem" href="../alternating_gradient_descent/">Alternating Gradient Descent</a></li><li><a class="tocitem" href="../augmented_Lagrangian_method/">Augmented Lagrangian Method</a></li><li><a class="tocitem" href="../ChambollePock/">Chambolle-Pock</a></li><li><a class="tocitem" href="../conjugate_gradient_descent/">Conjugate gradient descent</a></li><li><a class="tocitem" href="../cyclic_proximal_point/">Cyclic Proximal Point</a></li><li><a class="tocitem" href="../difference_of_convex/">Difference of Convex</a></li><li><a class="tocitem" href="../DouglasRachford/">Douglas‚ÄîRachford</a></li><li><a class="tocitem" href="../exact_penalty_method/">Exact Penalty Method</a></li><li><a class="tocitem" href="../FrankWolfe/">Frank-Wolfe</a></li><li class="is-active"><a class="tocitem" href>Gradient Descent</a><ul class="internal"><li><a class="tocitem" href="#State"><span>State</span></a></li><li><a class="tocitem" href="#Direction-update-rules"><span>Direction update rules</span></a></li><li><a class="tocitem" href="#Debug-actions"><span>Debug actions</span></a></li><li><a class="tocitem" href="#Record-actions"><span>Record actions</span></a></li><li><a class="tocitem" href="#sec-gradient-descent-technical-details"><span>Technical details</span></a></li><li><a class="tocitem" href="#Literature"><span>Literature</span></a></li></ul></li><li><a class="tocitem" href="../LevenbergMarquardt/">Levenberg‚ÄìMarquardt</a></li><li><a class="tocitem" href="../NelderMead/">Nelder‚ÄìMead</a></li><li><a class="tocitem" href="../particle_swarm/">Particle Swarm Optimization</a></li><li><a class="tocitem" href="../primal_dual_semismooth_Newton/">Primal-dual Riemannian semismooth Newton</a></li><li><a class="tocitem" href="../quasi_Newton/">Quasi-Newton</a></li><li><a class="tocitem" href="../stochastic_gradient_descent/">Stochastic Gradient Descent</a></li><li><a class="tocitem" href="../subgradient/">Subgradient method</a></li><li><a class="tocitem" href="../truncated_conjugate_gradient_descent/">Steihaug-Toint TCG Method</a></li><li><a class="tocitem" href="../trust_regions/">Trust-Regions Solver</a></li></ul></li><li><span class="tocitem">Plans</span><ul><li><a class="tocitem" href="../../plans/">Specify a Solver</a></li><li><a class="tocitem" href="../../plans/problem/">Problem</a></li><li><a class="tocitem" href="../../plans/objective/">Objective</a></li><li><a class="tocitem" href="../../plans/state/">Solver State</a></li><li><a class="tocitem" href="../../plans/stepsize/">Stepsize</a></li><li><a class="tocitem" href="../../plans/stopping_criteria/">Stopping Criteria</a></li><li><a class="tocitem" href="../../plans/debug/">Debug Output</a></li><li><a class="tocitem" href="../../plans/record/">Recording values</a></li></ul></li><li><span class="tocitem">Helpers</span><ul><li><a class="tocitem" href="../../helpers/checks/">Checks</a></li><li><a class="tocitem" href="../../helpers/exports/">Exports</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing to Manopt.jl</a></li><li><a class="tocitem" href="../../extensions/">Extensions</a></li><li><a class="tocitem" href="../../notation/">Notation</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Gradient Descent</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gradient Descent</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaManifolds/Manopt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaManifolds/Manopt.jl/blob/master/docs/src/solvers/gradient_descent.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GradientDescentSolver"><a class="docs-heading-anchor" href="#GradientDescentSolver">Gradient descent</a><a id="GradientDescentSolver-1"></a><a class="docs-heading-anchor-permalink" href="#GradientDescentSolver" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.gradient_descent" href="#Manopt.gradient_descent"><code>Manopt.gradient_descent</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gradient_descent(M, f, grad_f, p=rand(M); kwargs...)
gradient_descent(M, gradient_objective, p=rand(M); kwargs...)</code></pre><p>perform a gradient descent</p><p class="math-container">\[p_{k+1} = \operatorname{retr}_{p_k}\bigl( s_k\operatorname{grad}f(p_k) \bigr),
\qquad k=0,1,‚Ä¶\]</p><p>with different choices of the stepsize <span>$s_k$</span> available (see <code>stepsize</code> option below).</p><p><strong>Input</strong></p><ul><li><code>M</code>      ‚Äì a manifold <span>$\mathcal M$</span></li><li><code>f</code>      ‚Äì a cost function <span>$f: \mathcal M‚Üí‚Ñù$</span> to find a minimizer <span>$p^*$</span> for</li><li><code>grad_f</code> ‚Äì the gradient <span>$\operatorname{grad}f: \mathcal M ‚Üí T\mathcal M$</span> of f as a function <code>(M, p) -&gt; X</code> or a function <code>(M, X, p) -&gt; X</code></li><li><code>p</code>      ‚Äì an initial value <code>p</code> <span>$= p_0 ‚àà \mathcal M$</span></li></ul><p>Alternatively to <code>f</code> and <code>grad_f</code> you can provide the <a href="../../plans/objective/#Manopt.AbstractManifoldGradientObjective"><code>AbstractManifoldGradientObjective</code></a> <code>gradient_objective</code> directly.</p><p><strong>Optional</strong></p><ul><li><code>direction</code>          ‚Äì (<a href="#Manopt.IdentityUpdateRule"><code>IdentityUpdateRule</code></a>) perform a processing of the direction, e.g.</li><li><code>evaluation</code>         ‚Äì (<a href="../../plans/objective/#Manopt.AllocatingEvaluation"><code>AllocatingEvaluation</code></a>) specify whether the gradient works by allocation (default) form <code>grad_f(M, p)</code> or <a href="../../plans/objective/#Manopt.InplaceEvaluation"><code>InplaceEvaluation</code></a> in place, i.e. is of the form <code>grad_f!(M, X, p)</code>.</li><li><code>retraction_method</code>  ‚Äì (<a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/retractions/#ManifoldsBase.default_retraction_method-Tuple{AbstractManifold}"><code>default_retraction_method</code></a>(M, typeof(p))`) a retraction to use</li><li><code>stepsize</code>           ‚Äì (<a href="../../plans/stepsize/#Manopt.default_stepsize-Tuple{AbstractManifold, Type{&lt;:AbstractManoptSolverState}}"><code>default_stepsize</code></a><code>(M, GradientDescentState)</code>) a <a href="../../plans/stepsize/#Manopt.Stepsize"><code>Stepsize</code></a></li><li><code>stopping_criterion</code> ‚Äì (<a href="../../plans/stopping_criteria/#Manopt.StopAfterIteration"><code>StopAfterIteration</code></a><code>(200) |</code><a href="../../plans/stopping_criteria/#Manopt.StopWhenGradientNormLess"><code>StopWhenGradientNormLess</code></a><code>(1e-8)</code>) a functor inheriting from <a href="../../plans/stopping_criteria/#Manopt.StoppingCriterion"><code>StoppingCriterion</code></a> indicating when to stop.</li><li><code>X</code>                  - ([<code>zero_vector(M,p)</code>]) provide memory and/or type of the gradient to use`</li></ul><p>If you provide the <a href="../../plans/objective/#Manopt.ManifoldGradientObjective"><code>ManifoldGradientObjective</code></a> directly, <code>evaluation</code> is ignored.</p><p>All other keyword arguments are passed to <a href="../../plans/state/#Manopt.decorate_state!"><code>decorate_state!</code></a> for state decorators or <a href="../../plans/objective/#Manopt.decorate_objective!"><code>decorate_objective!</code></a> for objective, respectively. If you provide the <a href="../../plans/objective/#Manopt.ManifoldGradientObjective"><code>ManifoldGradientObjective</code></a> directly, these decorations can still be specified</p><p><strong>Output</strong></p><p>the obtained (approximate) minimizer <span>$p^*$</span>. To obtain the whole final state of the solver, see <a href="../#Manopt.get_solver_return"><code>get_solver_return</code></a> for details</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/solvers/gradient_descent.jl#L114-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.gradient_descent!" href="#Manopt.gradient_descent!"><code>Manopt.gradient_descent!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gradient_descent!(M, f, grad_f, p; kwargs...)
gradient_descent!(M, gradient_objective, p; kwargs...)</code></pre><p>perform a gradient_descent</p><p class="math-container">\[p_{k+1} = \operatorname{retr}_{p_k}\bigl( s_k\operatorname{grad}f(p_k) \bigr)\]</p><p>in place of <code>p</code> with different choices of <span>$s_k$</span> available.</p><p><strong>Input</strong></p><ul><li><code>M</code> ‚Äì a manifold <span>$\mathcal M$</span></li><li><code>f</code> ‚Äì a cost function <span>$F:\mathcal M‚Üí‚Ñù$</span> to minimize</li><li><code>grad_f</code> ‚Äì the gradient <span>$\operatorname{grad}F:\mathcal M‚Üí T\mathcal M$</span> of F</li><li><code>p</code> ‚Äì an initial value <span>$p ‚àà \mathcal M$</span></li></ul><p>Alternatively to <code>f</code> and <code>grad_f</code> you can provide the <a href="../../plans/objective/#Manopt.AbstractManifoldGradientObjective"><code>AbstractManifoldGradientObjective</code></a> <code>gradient_objective</code> directly.</p><p>For more options, especially <a href="../../plans/stepsize/#Manopt.Stepsize"><code>Stepsize</code></a>s for <span>$s_k$</span>, see <a href="#Manopt.gradient_descent"><code>gradient_descent</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/solvers/gradient_descent.jl#L197-L220">source</a></section></article><h2 id="State"><a class="docs-heading-anchor" href="#State">State</a><a id="State-1"></a><a class="docs-heading-anchor-permalink" href="#State" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.GradientDescentState" href="#Manopt.GradientDescentState"><code>Manopt.GradientDescentState</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GradientDescentState{P,T} &lt;: AbstractGradientSolverState</code></pre><p>Describes a Gradient based descent algorithm, with</p><p><strong>Fields</strong></p><p>a default value is given in brackets if a parameter can be left out in initialization.</p><ul><li><code>p</code> ‚Äì (<code>rand(M)</code> the current iterate</li><li><code>X</code> ‚Äì (<code>zero_vector(M,p)</code>) the current gradient <span>$\operatorname{grad}f(p)$</span>, initialised to zero vector.</li><li><code>stopping_criterion</code> ‚Äì (<a href="../../plans/stopping_criteria/#Manopt.StopAfterIteration"><code>StopAfterIteration</code></a><code>(100)</code>) a <a href="../../plans/stopping_criteria/#Manopt.StoppingCriterion"><code>StoppingCriterion</code></a></li><li><code>stepsize</code> ‚Äì (<a href="../../plans/stepsize/#Manopt.default_stepsize-Tuple{AbstractManifold, Type{&lt;:AbstractManoptSolverState}}"><code>default_stepsize</code></a><code>(M, GradientDescentState)</code>) a <a href="../../plans/stepsize/#Manopt.Stepsize"><code>Stepsize</code></a></li><li><code>direction</code> - (<a href="#Manopt.IdentityUpdateRule"><code>IdentityUpdateRule</code></a>) a processor to compute the gradient</li><li><code>retraction_method</code> ‚Äì (<code>default_retraction_method(M, typeof(p))</code>) the retraction to use, defaults to the default set for your manifold.</li></ul><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">GradientDescentState(M, p=rand(M); X=zero_vector(M, p), kwargs...)</code></pre><p>Generate gradient descent options, where <code>X</code> can be used to set the tangent vector to store the gradient in a certain type; it will be initialised accordingly at a later stage. All following fields are keyword arguments.</p><p><strong>See also</strong></p><p><a href="#Manopt.gradient_descent"><code>gradient_descent</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/solvers/gradient_descent.jl#L2-L29">source</a></section></article><h2 id="Direction-update-rules"><a class="docs-heading-anchor" href="#Direction-update-rules">Direction update rules</a><a id="Direction-update-rules-1"></a><a class="docs-heading-anchor-permalink" href="#Direction-update-rules" title="Permalink"></a></h2><p>A field of the options is the <code>direction</code>, a <a href="#Manopt.DirectionUpdateRule"><code>DirectionUpdateRule</code></a>, which by default <a href="#Manopt.IdentityUpdateRule"><code>IdentityUpdateRule</code></a> just evaluates the gradient but can be enhanced for example to</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.DirectionUpdateRule" href="#Manopt.DirectionUpdateRule"><code>Manopt.DirectionUpdateRule</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DirectionUpdateRule</code></pre><p>A general functor, that handles direction update rules. It&#39;s field(s) is usually only a <a href="../../plans/state/#Manopt.StoreStateAction"><code>StoreStateAction</code></a> by default initialized to the fields required for the specific coefficient, but can also be replaced by a (common, global) individual one that provides these values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L251-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.IdentityUpdateRule" href="#Manopt.IdentityUpdateRule"><code>Manopt.IdentityUpdateRule</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">IdentityUpdateRule &lt;: DirectionUpdateRule</code></pre><p>The default gradient direction update is the identity, i.e. it just evaluates the gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L261-L265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.MomentumGradient" href="#Manopt.MomentumGradient"><code>Manopt.MomentumGradient</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MomentumGradient &lt;: DirectionUpdateRule</code></pre><p>Append a momentum to a gradient processor, where the last direction and last iterate are stored and the new is composed as <span>$Œ∑_i = m*Œ∑_{i-1}&#39; - s d_i$</span>, where <span>$sd_i$</span> is the current (inner) direction and <span>$Œ∑_{i-1}&#39;$</span> is the vector transported last direction multiplied by momentum <span>$m$</span>.</p><p><strong>Fields</strong></p><ul><li><code>p_old</code> - (<code>rand(M)</code>) remember the last iterate for parallel transporting the last direction</li><li><code>momentum</code> ‚Äì (<code>0.2</code>) factor for momentum</li><li><code>direction</code> ‚Äì internal <a href="#Manopt.DirectionUpdateRule"><code>DirectionUpdateRule</code></a> to determine directions to add the momentum to.</li><li><code>vector_transport_method</code> ‚Äì <code>default_vector_transport_method(M, typeof(p))</code> vector transport method to use</li><li><code>X_old</code> ‚Äì (<code>zero_vector(M,x0)</code>) the last gradient/direction update added as momentum</li></ul><p><strong>Constructors</strong></p><p>Add momentum to a gradient problem, where by default just a gradient evaluation is used</p><pre><code class="nohighlight hljs">MomentumGradient(
    M::AbstractManifold;
    p=rand(M),
    s::DirectionUpdateRule=IdentityUpdateRule();
    X=zero_vector(p.M, x0), momentum=0.2
    vector_transport_method=default_vector_transport_method(M, typeof(p)),
)</code></pre><p>Initialize a momentum gradient rule to <code>s</code>. Note that the keyword arguments <code>p</code> and <code>X</code> will be overridden often, so their initialisation is meant to set the to certain types of points or tangent vectors, if you do not use the default types with respect to <code>M</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L268-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.AverageGradient" href="#Manopt.AverageGradient"><code>Manopt.AverageGradient</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AverageGradient &lt;: DirectionUpdateRule</code></pre><p>Add an average of gradients to a gradient processor. A set of previous directions (from the inner processor) and the last iterate are stored, average is taken after vector transporting them to the current iterates tangent space.</p><p><strong>Fields</strong></p><ul><li><code>gradients</code> ‚Äì (fill(<code>zero_vector(M,x0),n)</code>) the last <code>n</code> gradient/direction updates</li><li><code>last_iterate</code> ‚Äì last iterate (needed to transport the gradients)</li><li><code>direction</code> ‚Äì internal <a href="#Manopt.DirectionUpdateRule"><code>DirectionUpdateRule</code></a> to determine directions to apply the averaging to</li><li><code>vector_transport_method</code> - vector transport method to use</li></ul><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">AverageGradient(
    M::AbstractManifold,
    p::P=rand(M);
    n::Int=10
    s::DirectionUpdateRule=IdentityUpdateRule();
    gradients = fill(zero_vector(p.M, o.x),n),
    last_iterate = deepcopy(x0),
    vector_transport_method = default_vector_transport_method(M, typeof(p))
)</code></pre><p>Add average to a gradient problem, where</p><ul><li><code>n</code> determines the size of averaging</li><li><code>s</code> is the internal <a href="#Manopt.DirectionUpdateRule"><code>DirectionUpdateRule</code></a> to determine the gradients to store</li><li><code>gradients</code> can be prefilled with some history</li><li><code>last_iterate</code> stores the last iterate</li><li><code>vector_transport_method</code> determines how to transport all gradients to the current iterates tangent space before averaging</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L334-L366">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.Nesterov" href="#Manopt.Nesterov"><code>Manopt.Nesterov</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Nesterov &lt;: DirectionUpdateRule</code></pre><p><strong>Fields</strong></p><ul><li><code>Œ≥</code></li><li><code>Œº</code> the strong convexity coefficient</li><li><code>v</code> (=<span>$=v_k$</span>, <span>$v_0=x_0$</span>) an interims point to compute the next gradient evaluation point <code>y_k</code></li><li><code>shrinkage</code> (<code>= i -&gt; 0.8</code>) a function to compute the shrinkage <span>$Œ≤_k$</span> per iterate.</li></ul><p>Let&#39;s assume <span>$f$</span> is <span>$L$</span>-Lipschitz and <span>$Œº$</span>-strongly convex. Given</p><ul><li>a step size <span>$h_k&lt;\frac{1}{L}$</span> (from the <a href="#Manopt.GradientDescentState"><code>GradientDescentState</code></a></li><li>a <code>shrinkage</code> parameter <span>$Œ≤_k$</span></li><li>and a current iterate <span>$x_k$</span></li><li>as well as the interims values <span>$Œ≥_k$</span> and <span>$v_k$</span> from the previous iterate.</li></ul><p>This compute a Nesterov type update using the following steps, see <a href="../../references/#ZhangSra:2018">Zhang, Sra, Preprint, 2018</a></p><ol><li>Compute the positive root, i.e. <span>$Œ±_k‚àà(0,1)$</span> of <span>$Œ±^2 = h_k\bigl((1-Œ±_k)Œ≥_k+Œ±_k Œº\bigr)$</span>.</li><li>Set <span>$\bar Œ≥_k+1 = (1-Œ±_k)Œ≥_k + Œ±_kŒº$</span></li><li><span>$y_k = \operatorname{retr}_{x_k}\Bigl(\frac{Œ±_kŒ≥_k}{Œ≥_k + Œ±_kŒº}\operatorname{retr}^{-1}_{x_k}v_k \Bigr)$</span></li><li><span>$x_{k+1} = \operatorname{retr}_{y_k}(-h_k \operatorname{grad}f(y_k))$</span></li><li><span>$v_{k+1} = `\operatorname{retr}_{y_k}\Bigl(\frac{(1-Œ±_k)Œ≥_k}{\barŒ≥_k}\operatorname{retr}_{y_k}^{-1}(v_k) - \frac{Œ±_k}{\bar Œ≥_{k+1}}\operatorname{grad}f(y_k) \Bigr)$</span></li><li><span>$Œ≥_{k+1} = \frac{1}{1+Œ≤_k}\bar Œ≥_{k+1}$</span></li></ol><p>Then the direction from <span>$x_k$</span> to <span>$x_k+1$</span>, i.e. <span>$d = \operatorname{retr}^{-1}_{x_k}x_{k+1}$</span> is returned.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">Nesterov(M::AbstractManifold, p::P; Œ≥=0.001, Œº=0.9, shrinkage = k -&gt; 0.8;
    inverse_retraction_method=LogarithmicInverseRetraction())</code></pre><p>Initialize the Nesterov acceleration, where <code>x0</code> initializes <code>v</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L406-L438">source</a></section></article><h2 id="Debug-actions"><a class="docs-heading-anchor" href="#Debug-actions">Debug actions</a><a id="Debug-actions-1"></a><a class="docs-heading-anchor-permalink" href="#Debug-actions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.DebugGradient" href="#Manopt.DebugGradient"><code>Manopt.DebugGradient</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DebugGradient &lt;: DebugAction</code></pre><p>debug for the gradient evaluated at the current iterate</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">DebugGradient(; long=false, prefix= , format= &quot;$prefix%s&quot;, io=stdout)</code></pre><p>display the short (<code>false</code>) or long (<code>true</code>) default text for the gradient, or set the <code>prefix</code> manually. Alternatively the complete format can be set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L481-L491">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.DebugGradientNorm" href="#Manopt.DebugGradientNorm"><code>Manopt.DebugGradientNorm</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DebugGradientNorm &lt;: DebugAction</code></pre><p>debug for gradient evaluated at the current iterate.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">DebugGradientNorm([long=false,p=print])</code></pre><p>display the short (<code>false</code>) or long (<code>true</code>) default text for the gradient norm.</p><pre><code class="nohighlight hljs">DebugGradientNorm(prefix[, p=print])</code></pre><p>display the a <code>prefix</code> in front of the gradientnorm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L514-L527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.DebugStepsize" href="#Manopt.DebugStepsize"><code>Manopt.DebugStepsize</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DebugStepsize &lt;: DebugAction</code></pre><p>debug for the current step size.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">DebugStepsize(;long=false,prefix=&quot;step size:&quot;, format=&quot;$prefix%s&quot;, io=stdout)</code></pre><p>display the a <code>prefix</code> in front of the step size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L556-L565">source</a></section></article><h2 id="Record-actions"><a class="docs-heading-anchor" href="#Record-actions">Record actions</a><a id="Record-actions-1"></a><a class="docs-heading-anchor-permalink" href="#Record-actions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.RecordGradient" href="#Manopt.RecordGradient"><code>Manopt.RecordGradient</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RecordGradient &lt;: RecordAction</code></pre><p>record the gradient evaluated at the current iterate</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">RecordGradient(Œæ)</code></pre><p>initialize the <a href="../../plans/record/#Manopt.RecordAction"><code>RecordAction</code></a> to the corresponding type of the tangent vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L592-L601">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.RecordGradientNorm" href="#Manopt.RecordGradientNorm"><code>Manopt.RecordGradientNorm</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RecordGradientNorm &lt;: RecordAction</code></pre><p>record the norm of the current gradient</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L614-L618">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Manopt.RecordStepsize" href="#Manopt.RecordStepsize"><code>Manopt.RecordStepsize</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RecordStepsize &lt;: RecordAction</code></pre><p>record the step size</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaManifolds/Manopt.jl/blob/86a2866c57383a28f4ba159586145efa7567e565/src/plans/gradient_plan.jl#L631-L635">source</a></section></article><h2 id="sec-gradient-descent-technical-details"><a class="docs-heading-anchor" href="#sec-gradient-descent-technical-details">Technical details</a><a id="sec-gradient-descent-technical-details-1"></a><a class="docs-heading-anchor-permalink" href="#sec-gradient-descent-technical-details" title="Permalink"></a></h2><p>The <a href="#Manopt.gradient_descent"><code>gradient_descent</code></a> solver requires the following functions of a manifold to be available</p><ul><li>A <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/retractions/"><code>retract!</code></a><code>(M, q, p, X)</code>; it is recommended to set the <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/retractions/#ManifoldsBase.default_retraction_method-Tuple{AbstractManifold}"><code>default_retraction_method</code></a> to a favourite retraction. If this default is set, a <code>retraction_method=</code> does not have to be specified.</li><li>By default gradient descent uses <a href="../../plans/stepsize/#Manopt.ArmijoLinesearch"><code>ArmijoLinesearch</code></a> which requires <a href="../../extensions/#Manopt.max_stepsize-Tuple{FiberBundle{ùîΩ, ManifoldsBase.TangentSpaceType, M} where {ùîΩ, M&lt;:AbstractManifold{ùîΩ}}, Any}"><code>max_stepsize</code></a><code>(M)</code> to be set and an implementation of <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/functions/#ManifoldsBase.inner-Tuple%7BAbstractManifold,%20Any,%20Any,%20Any%7D"><code>inner</code></a><code>(M, p, X)</code>.</li><li>By default the stopping criterion uses the <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/functions/#LinearAlgebra.norm-Tuple{AbstractManifold,%20Any,%20Any}"><code>norm</code></a> as well, to stop when the norm of the gradient is small, but if you implemented <code>inner</code>, the norm is provided already.</li><li>By default the tangent vector storing the gradient is initialized calling <a href="https://juliamanifolds.github.io/ManifoldsBase.jl/stable/functions/#ManifoldsBase.zero_vector-Tuple{AbstractManifold,%20Any}"><code>zero_vector</code></a><code>(M,p)</code>.</li></ul><h2 id="Literature"><a class="docs-heading-anchor" href="#Literature">Literature</a><a id="Literature-1"></a><a class="docs-heading-anchor-permalink" href="#Literature" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[Lue72]</dt><dd><div>D.¬†G.¬†Luenberger. <em>The gradient projection method along geodesics</em>. Management¬†Science <strong>18</strong>, 620‚Äì631 (1972).</div></dd><dt>[ZS18]</dt><dd><div>H.¬†Zhang and S.¬†Sra. <a href="https://arxiv.org/abs/1806.02812"><em>Towards Riemannian accelerated gradient methods</em></a>, arXiv¬†Preprint,¬†1806.02812 (2018).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../FrankWolfe/">¬´ Frank-Wolfe</a><a class="docs-footer-nextpage" href="../LevenbergMarquardt/">Levenberg‚ÄìMarquardt ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 16 January 2024 09:50">Tuesday 16 January 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
