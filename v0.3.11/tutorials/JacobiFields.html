<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>use Jacobi Fields · Manopt.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="Manopt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Manopt.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../about.html">About</a></li><li><span class="tocitem">How to...</span><ul><li><a class="tocitem" href="MeanAndMedian.html">get Started: Optimize!</a></li><li><a class="tocitem" href="Benchmark.html">speed up! using <code>gradF!</code></a></li><li><a class="tocitem" href="GeodesicRegression.html">Do Geodesic regression</a></li><li><a class="tocitem" href="HowToRecord.html">Record values</a></li><li><a class="tocitem" href="StochasticGradientDescent.html">do stochastic gradient descent</a></li><li><a class="tocitem" href="BezierCurves.html">work with Bézier curves</a></li><li><a class="tocitem" href="GradientOfSecondOrderDifference.html">see the gradient of <span>$d_2$</span></a></li><li class="is-active"><a class="tocitem" href="JacobiFields.html">use Jacobi Fields</a><ul class="internal"><li><a class="tocitem" href="#Literature-1"><span>Literature</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../plans/index.html">Plans</a></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../solvers/index.html">Introduction</a></li><li><a class="tocitem" href="../solvers/alternating_gradient_descent.html">Alternating Gradient Descent</a></li><li><a class="tocitem" href="../solvers/ChambollePock.html">Chambolle-Pock</a></li><li><a class="tocitem" href="../solvers/conjugate_gradient_descent.html">Conjugate gradient descent</a></li><li><a class="tocitem" href="../solvers/cyclic_proximal_point.html">Cyclic Proximal Point</a></li><li><a class="tocitem" href="../solvers/DouglasRachford.html">Douglas–Rachford</a></li><li><a class="tocitem" href="../solvers/gradient_descent.html">Gradient Descent</a></li><li><a class="tocitem" href="../solvers/NelderMead.html">Nelder–Mead</a></li><li><a class="tocitem" href="../solvers/particle_swarm.html">Particle Swarm Optimization</a></li><li><a class="tocitem" href="../solvers/quasi_Newton.html">Quasi-Newton</a></li><li><a class="tocitem" href="../solvers/stochastic_gradient_descent.html">Stochastic Gradient Descent</a></li><li><a class="tocitem" href="../solvers/subgradient.html">Subgradient method</a></li><li><a class="tocitem" href="../solvers/truncated_conjugate_gradient_descent.html">Steihaug-Toint TCG Method</a></li><li><a class="tocitem" href="../solvers/trust_regions.html">Trust-Regions Solver</a></li></ul></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../functions/index.html">Introduction</a></li><li><a class="tocitem" href="../functions/bezier.html">Bézier curves</a></li><li><a class="tocitem" href="../functions/costs.html">Cost functions</a></li><li><a class="tocitem" href="../functions/differentials.html">Differentials</a></li><li><a class="tocitem" href="../functions/adjointdifferentials.html">Adjoint Differentials</a></li><li><a class="tocitem" href="../functions/gradients.html">Gradients</a></li><li><a class="tocitem" href="../functions/Jacobi_fields.html">Jacobi Fields</a></li><li><a class="tocitem" href="../functions/proximal_maps.html">Proximal Maps</a></li><li><a class="tocitem" href="../functions/manifold.html">Specific Manifold Functions</a></li></ul></li><li><span class="tocitem">Helpers</span><ul><li><a class="tocitem" href="../helpers/data.html">Data</a></li><li><a class="tocitem" href="../helpers/errorMeasures.html">Error Measures</a></li><li><a class="tocitem" href="../helpers/exports.html">Exports</a></li></ul></li><li><a class="tocitem" href="../notation.html">Notation</a></li><li><a class="tocitem" href="../list.html">Function Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to...</a></li><li class="is-active"><a href="JacobiFields.html">use Jacobi Fields</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="JacobiFields.html">use Jacobi Fields</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaManifolds/Manopt.jl/blob/master/src/tutorials/JacobiFields.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Illustration-of-Jacobi-Fields-1"><a class="docs-heading-anchor" href="#Illustration-of-Jacobi-Fields-1">Illustration of Jacobi Fields</a><a class="docs-heading-anchor-permalink" href="#Illustration-of-Jacobi-Fields-1" title="Permalink"></a></h1><p>This tutorial illustrates the usage of Jacobi Fields within <code>Manopt.jl</code>. For this tutorial you should be familiar with the basic terminology on a manifold like the exponential and logarithmic map as well as <a href="https://juliamanifolds.github.io/Manifolds.jl/stable/interface.html#ManifoldsBase.shortest_geodesic-Tuple{Manifold,Any,Any}">shortest geodesic</a>s.</p><p>We first initialize the manifold</p><pre><code class="language-julia">using Manopt, Manifolds</code></pre><p>and we define some colors from <a href="https://personal.sron.nl/~pault/">Paul Tol</a></p><pre><code class="language-julia">using Colors
black = RGBA{Float64}(colorant&quot;#000000&quot;)
TolVibrantOrange = RGBA{Float64}(colorant&quot;#EE7733&quot;)
TolVibrantCyan = RGBA{Float64}(colorant&quot;#33BBEE&quot;)
TolVibrantTeal = RGBA{Float64}(colorant&quot;#009988&quot;)</code></pre><p>Assume we have two points on the equator of the <a href="https://juliamanifolds.github.io/Manifolds.jl/stable/manifolds/sphere.html">Sphere</a> <span>$\mathcal M = \mathbb S^2$</span></p><pre><code class="language-julia">M = Sphere(2)
p, q = [[1.0, 0.0, 0.0], [0.0, 1.0, 0.0]]</code></pre><pre><code class="language-none">2-element Array{Array{Float64,1},1}:
 [1.0, 0.0, 0.0]
 [0.0, 1.0, 0.0]</code></pre><p>their connecting <a href="https://juliamanifolds.github.io/Manifolds.jl/stable/interface.html#ManifoldsBase.shortest_geodesic-Tuple{Manifold,Any,Any}">shortest geodesic</a> (sampled at <code>100</code> points)</p><pre><code class="language-julia">geodesicCurve = shortest_geodesic(M, p, q, [0:0.1:1.0...]);</code></pre><p>looks as follows using the <a href="../helpers/exports.html#Manopt.asymptote_export_S2_signals-Tuple{String}"><code>asymptote_export_S2_signals</code></a> export</p><pre><code class="language-julia">asymptote_export_S2_signals(&quot;jacobiGeodesic.asy&quot;;
    render = asyResolution,
    curves=[geodesicCurve], points = [ [x,y] ],
    colors=Dict(:curves =&gt; [black], :points =&gt; [TolVibrantOrange]),
    dot_size = 3.5, line_width = 0.75, camera_position = (1.,1.,.5)
)
render_asymptote(&quot;jacobiGeodesic.asy&quot;; render = 2)</code></pre><p><img src="../assets/images/tutorials/jacobiGeodesic.png" alt="A geodesic connecting two points on the equator"/></p><p>where <span>$x$</span> is on the left. Then this tutorial solves the following task:</p><p>Given a direction <span>$X_p∈ T_x\mathcal M$</span>, for example</p><pre><code class="language-julia">X = [0.0, 0.4, 0.5]</code></pre><pre><code class="language-none">3-element Array{Float64,1}:
 0.0
 0.4
 0.5</code></pre><p>we move the start point <span>$x$</span> into, how does any point on the geodesic move?</p><p>Or mathematically: Compute <span>$D_p g(t; p,q)$</span> for some fixed <span>$t∈[0,1]$</span> and a given direction <span>$X_p$</span>. Of course two cases are quite easy: For <span>$t=0$</span> we are in <span>$x$</span> and how <span>$x$</span> “moves” is already known, so <span>$D_x g(0;p,q) = X$</span>. On the other side, for <span>$t=1$</span>, <span>$g(1; p,q) = q$</span> which is fixed, so <span>$D_p g(1; p,q)$</span> is the zero tangent vector (in <span>$T_q\mathcal M$</span>).</p><p>For all other cases we employ a <a href="../functions/Jacobi_fields.html#Manopt.jacobi_field"><code>jacobi_field</code></a>, which is a (tangent) vector field along the <a href="https://juliamanifolds.github.io/Manifolds.jl/stable/interface.html#ManifoldsBase.shortest_geodesic-Tuple{Manifold,Any,Any}">shortest geodesic</a> given as follows: The <em>geodesic variation</em> <span>$\Gamma_{g,X}(s,t)$</span> is defined for some <span>$\varepsilon &gt; 0$</span> as</p><div>\[\Gamma_{g,X}(s,t):=\exp{\gamma_{p,X}(s)}[t\log_{g(s;p,X)}p],\qquad s∈(-\varepsilon,\varepsilon),\ t∈[0,1].\]</div><p>Intuitively we make a small step <span>$s$</span> into direction <span>$ξ$</span> using the geodesic <span>$g(⋅; p,X)$</span> and from <span>$r=g(s; p,X)$</span> we follow (in <span>$t$</span>) the geodesic <span>$g(⋅; r,q)$</span>. The corresponding Jacobi field <span>$J_{g,X}$</span> along <span>$g(⋅; p,q)$</span> is given by</p><div>\[J_{g,X}(t):=\frac{D}{\partial s}\Gamma_{g,X}(s,t)\Bigl\rvert_{s=0}\]</div><p>which is an ODE and we know the boundary conditions <span>$J_{g,X}(0)=X$</span> and <span>$J_{g,X}(t) = 0$</span>. In symmetric spaces we can compute the solution, since the system of ODEs decouples, see for example <a href="#doCarmo1992">do Carmo</a>, Chapter 4.2. Within <code>Manopt.jl</code> this is implemented as <a href="../functions/Jacobi_fields.html#Manopt.jacobi_field"><code>jacobi_field</code></a><code>(M,p,q,t,X[,β])</code>, where the optional parameter (function) <code>β</code> specifies, which Jacobi field we want to evaluate and the one used here is the default.</p><p>We can hence evaluate that on the points on the geodesic at</p><pre><code class="language-julia">T = [0:0.1:1.0...]</code></pre><p>namely</p><pre><code class="language-julia">r = shortest_geodesic(M, p, q, T)</code></pre><p>the geodesic moves as</p><pre><code class="language-julia">W = jacobi_field.(Ref(M), Ref(p), Ref(q), T, Ref(X))</code></pre><pre><code class="language-none">11-element Array{Array{Float64,1},1}:
 [0.0, 0.4, 0.5]
 [-0.05631640741448312, 0.35556780261424964, 0.4938441702975689]
 [-0.09888543819998319, 0.3043380852144492, 0.47552825814757677]
 [-0.12711733992707308, 0.249481826772743, 0.4455032620941839]
 [-0.14106846055019354, 0.1941640786499874, 0.4045084971874737]
 [-0.1414213562373095, 0.14142135623730953, 0.35355339059327373]
 [-0.1294427190999916, 0.09404564036679572, 0.29389262614623657]
 [-0.10692078290260418, 0.05447885996874562, 0.2269952498697734]
 [-0.07608452130361228, 0.024721359549995783, 0.15450849718747367]
 [-0.039507533623805505, 0.006257378601609233, 0.07821723252011542]
 [0.0, 0.0, 0.0]</code></pre><p>which can also be called using <a href="../functions/differentials.html#Manopt.differential_geodesic_startpoint-Tuple{AbstractManifold,Any,Any,Any,Any}"><code>differential_geodesic_startpoint</code></a>. We can add to the image above by creating extended tangent vectors the include their base points</p><pre><code class="language-julia">V = [Tuple([a, b]) for (a, b) in zip(r, W)]</code></pre><pre><code class="language-none">11-element Array{Tuple{Array{Float64,1},Array{Float64,1}},1}:
 ([1.0, 0.0, 0.0], [0.0, 0.4, 0.5])
 ([0.9876883405951378, 0.15643446504023087, 0.0], [-0.05631640741448312, 0.35556780261424964, 0.4938441702975689])
 ([0.9510565162951535, 0.3090169943749474, 0.0], [-0.09888543819998319, 0.3043380852144492, 0.47552825814757677])
 ([0.8910065241883679, 0.45399049973954675, 0.0], [-0.12711733992707308, 0.249481826772743, 0.4455032620941839])
 ([0.8090169943749475, 0.5877852522924731, 0.0], [-0.14106846055019354, 0.1941640786499874, 0.4045084971874737])
 ([0.7071067811865476, 0.7071067811865475, 0.0], [-0.1414213562373095, 0.14142135623730953, 0.35355339059327373])
 ([0.5877852522924731, 0.8090169943749475, 0.0], [-0.1294427190999916, 0.09404564036679572, 0.29389262614623657])
 ([0.45399049973954686, 0.8910065241883678, 0.0], [-0.10692078290260418, 0.05447885996874562, 0.2269952498697734])
 ([0.30901699437494745, 0.9510565162951536, 0.0], [-0.07608452130361228, 0.024721359549995783, 0.15450849718747367])
 ([0.15643446504023092, 0.9876883405951378, 0.0], [-0.039507533623805505, 0.006257378601609233, 0.07821723252011542])
 ([6.123233995736766e-17, 1.0, 0.0], [0.0, 0.0, 0.0])</code></pre><p>and add that as one further set to the Asymptote export.</p><pre><code class="language-julia">asymptote_export_S2_signals(&quot;jacobiGeodesicdifferential_geodesic_startpoint.asy&quot;;
    render = asyResolution,
    curves=[geodesicCurve], points = [ [x,y], Z], tangent_vectors = [Vx],
    colors=Dict(
        :curves =&gt; [black],
        :points =&gt; [TolVibrantOrange,TolVibrantCyan],
        :tvectors =&gt; [TolVibrantCyan]
    ),
    dot_sizes = [3.5,2.], line_width = 0.75, camera_position = (1.,1.,.5)
)
render_asymptote(&quot;jacobiGeodesicdifferential_geodesic_startpoint.asy&quot;; render = 2)</code></pre><p><img src="../assets/images/tutorials/jacobiGeodesicdifferential_geodesic_startpoint.png" alt="A Jacobi field for \$D_xg(t,x,y)[η]\$"/></p><p>If we further move the end point, too, we can derive that Differential in direction</p><pre><code class="language-julia">Xq = [0.2, 0.0, -0.5]
W2 = differential_geodesic_endpoint.(Ref(M), Ref(p), Ref(q), T, Ref(Xq))
V2 = [Tuple([a, b]) for (a, b) in zip(r, W2)]</code></pre><pre><code class="language-none">11-element Array{Tuple{Array{Float64,1},Array{Float64,1}},1}:
 ([1.0, 0.0, 0.0], [0.0, -0.0, 0.0])
 ([0.9876883405951378, 0.15643446504023087, 0.0], [0.0031286893008046165, -0.019753766811902752, -0.07821723252011542])
 ([0.9510565162951535, 0.3090169943749474, 0.0], [0.012360679774997892, -0.03804226065180614, -0.15450849718747367])
 ([0.8910065241883679, 0.45399049973954675, 0.0], [0.02723942998437282, -0.053460391451302075, -0.2269952498697734])
 ([0.8090169943749475, 0.5877852522924731, 0.0], [0.04702282018339786, -0.0647213595499958, -0.29389262614623657])
 ([0.7071067811865476, 0.7071067811865475, 0.0], [0.07071067811865477, -0.07071067811865475, -0.35355339059327373])
 ([0.5877852522924731, 0.8090169943749475, 0.0], [0.0970820393249937, -0.07053423027509677, -0.4045084971874737])
 ([0.45399049973954686, 0.8910065241883678, 0.0], [0.1247409133863715, -0.06355866996353654, -0.4455032620941839])
 ([0.30901699437494745, 0.9510565162951536, 0.0], [0.1521690426072246, -0.04944271909999159, -0.47552825814757677])
 ([0.15643446504023092, 0.9876883405951378, 0.0], [0.17778390130712482, -0.028158203707241553, -0.4938441702975689])
 ([6.123233995736766e-17, 1.0, 0.0], [0.2, 0.0, -0.5])</code></pre><p>and we can combine both keeping the base point</p><pre><code class="language-julia">V3 = [Tuple([a, b]) for (a, b) in zip(r, W2 + W)]</code></pre><pre><code class="language-none">11-element Array{Tuple{Array{Float64,1},Array{Float64,1}},1}:
 ([1.0, 0.0, 0.0], [0.0, 0.4, 0.5])
 ([0.9876883405951378, 0.15643446504023087, 0.0], [-0.053187718113678506, 0.33581403580234687, 0.41562693777745346])
 ([0.9510565162951535, 0.3090169943749474, 0.0], [-0.0865247584249853, 0.26629582456264306, 0.3210197609601031])
 ([0.8910065241883679, 0.45399049973954675, 0.0], [-0.09987790994270027, 0.19602143532144092, 0.2185080122244105])
 ([0.8090169943749475, 0.5877852522924731, 0.0], [-0.09404564036679568, 0.12944271909999158, 0.11061587104123716])
 ([0.7071067811865476, 0.7071067811865475, 0.0], [-0.07071067811865474, 0.07071067811865478, 0.0])
 ([0.5877852522924731, 0.8090169943749475, 0.0], [-0.032360679774997916, 0.02351141009169895, -0.11061587104123716])
 ([0.45399049973954686, 0.8910065241883678, 0.0], [0.01782013048376732, -0.009079809994790917, -0.2185080122244105])
 ([0.30901699437494745, 0.9510565162951536, 0.0], [0.07608452130361233, -0.024721359549995804, -0.3210197609601031])
 ([0.15643446504023092, 0.9876883405951378, 0.0], [0.1382763676833193, -0.02190082510563232, -0.41562693777745346])
 ([6.123233995736766e-17, 1.0, 0.0], [0.2, 0.0, -0.5])</code></pre><pre><code class="language-julia">asymptote_export_S2_signals(&quot;jacobiGeodesicResult.asy&quot;;
   render = asyResolution,
   curves=[geodesicCurve], points = [ [x,y], Z], tangent_vectors = [Vx,Vy,Vb],
   colors=Dict(
       :curves =&gt; [black],
       :points =&gt; [TolVibrantOrange,TolVibrantCyan],
       :tvectors =&gt; [TolVibrantCyan,TolVibrantCyan,TolVibrantTeal]
  ),
  dot_sizes = [3.5,2.], line_width = 0.75, camera_position = (1.,1.,0.)
)
render_asymptote(&quot;jacobiGeodesicResult.asy&quot;; render = 2)</code></pre><p><img src="../assets/images/tutorials/jacobiGeodesicResult.png" alt="A Jacobi field for the effect of two differentials (blue) in sum (teal)"/></p><h2 id="Literature-1"><a class="docs-heading-anchor" href="#Literature-1">Literature</a><a class="docs-heading-anchor-permalink" href="#Literature-1" title="Permalink"></a></h2><ul><li id="doCarmo1992">[<a>doCarmo1992</a>] do Carmo, M. P.:
   <emph>Riemannian Geometry</emph>, Mathematics: Theory & Applications,
   Birkhäuser Basel, 1992, ISBN: 0-8176-3490-8</li>
<li id="BergmannGousenbourger2018">[<a>BergmannGousenbourger2018</a>]
  Bergmann, R.; Gousenbourger, P.-Y.: <emph>A variational model for data
  fitting on manifolds by minimizing the acceleration of a Bézier curve</emph>,
  Frontiers in Applied Mathematics and Statistics, 2018.
  doi: <a href="https://dx.doi.org/10.3389/fams.2018.00059">10.3389/fams.2018.00059</a></li>
</ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="GradientOfSecondOrderDifference.html">« see the gradient of <span>$d_2$</span></a><a class="docs-footer-nextpage" href="../plans/index.html">Plans »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 2 July 2021 21:28">Friday 2 July 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
